import requests, xml.etree.ElementTree as ET, re
def fetch_exploitdb_data(max_items=10):
    try:
        url = 'https://www.exploit-db.com/rss.xml'
        r = requests.get(url, timeout=15)
        r.raise_for_status()
        root = ET.fromstring(r.content)
        items = root.findall('.//item')
        results = []
        for it in items[:max_items]:
            title = it.find('title').text if it.find('title') is not None else 'No title'
            desc = it.find('description').text if it.find('description') is not None else ''
            link = it.find('link').text if it.find('link') is not None else ''
            iocs = re.findall(r'https?://[^\s,;]+', desc)
            results.append({
                'id': title,
                'title': title,
                'description': desc,
                'iocs': iocs,
                'severity': 'Unknown',
                'published': it.find('pubDate').text if it.find('pubDate') is not None else '',
                'source': 'Exploit-DB'
            })
        return results
    except Exception as e:
        print('ExploitDB fetch error', e)
        return []
